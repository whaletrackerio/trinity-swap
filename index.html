<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TRINITY Swap ‚Äî PulseChain</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>

<style>
:root{
--bg:#050816;
--card:#0f172a;
--border:#1f2937;
--text:#e5e7eb;
--muted:#9ca3af;
--accent:#a855f7;
--accent2:#ec4899;
--good:#22c55e;
--bad:#ef4444;
--warn:#f59e0b;
--radius:18px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
background:radial-gradient(1200px 700px at 20% 0%,#0b102a 0%,#050816 55%,#020617 100%);
color:var(--text);
}
.wrap{max-width:1200px;margin:auto;padding:24px 16px 80px}
a{text-decoration:none;color:inherit}

header{
display:flex;justify-content:space-between;align-items:center;
position:sticky;top:0;z-index:50;
background:rgba(5,8,22,.8);
backdrop-filter:blur(10px);
padding:14px 10px;margin:-24px -16px 24px;
border-bottom:1px solid var(--border)
}
.brand{display:flex;align-items:center;gap:10px;font-weight:900}
.logo{
width:32px;height:32px;border-radius:10px;
background:linear-gradient(135deg,var(--accent),var(--accent2));
}

.pill{
font-size:12px;color:var(--muted);
border:1px solid var(--border);
padding:6px 10px;border-radius:999px
}
.btn{
border:none;cursor:pointer;
padding:10px 16px;border-radius:999px;
background:linear-gradient(120deg,var(--accent),var(--accent2));
color:white;font-weight:900
}
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn2{
border:1px solid var(--border);
background:transparent;
color:var(--text);
padding:10px 14px;border-radius:999px;
font-weight:800;cursor:pointer
}

.card{
background:linear-gradient(180deg,rgba(15,23,42,.95),rgba(15,23,42,.75));
border:1px solid var(--border);
border-radius:var(--radius);
padding:16px;
}

.hero{
display:grid;grid-template-columns:1.3fr .7fr;gap:16px
}
@media(max-width:900px){.hero{grid-template-columns:1fr}}

.chips{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
.chip{
font-size:12px;
border:1px solid var(--border);
padding:6px 10px;border-radius:999px
}

.warn{
border:1px solid rgba(245,158,11,.4);
background:rgba(245,158,11,.08);
padding:10px;border-radius:12px;font-size:12px;color:var(--muted)
}

h1{font-size:32px}

.swaps{
display:grid;grid-template-columns:repeat(3,1fr);
gap:16px;margin-top:20px
}
@media(max-width:900px){.swaps{grid-template-columns:1fr}}

label{font-size:12px;color:var(--muted)}
select,input{
width:100%;margin-top:6px;
padding:10px;border-radius:14px;
background:#020617;border:1px solid var(--border);
color:var(--text)
}

.row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.switch{text-align:center;margin:10px 0}
.switch button{
border:1px solid var(--border);
background:#020617;color:white;
padding:6px 10px;border-radius:10px;cursor:pointer
}

.balRow{
display:flex;justify-content:space-between;align-items:center;
margin-top:6px;font-size:12px;color:var(--muted)
}
.maxBtn{
border:1px solid var(--border);
background:#020617;color:white;
padding:4px 10px;border-radius:999px;
cursor:pointer;font-weight:900
}

.status{margin-top:10px;font-size:12px;color:var(--muted)}
.good{color:var(--good)}
.bad{color:var(--bad)}
.warnTxt{color:var(--warn)}

.links{margin-top:20px;display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:900px){.links{grid-template-columns:1fr}}
.linkItem{
display:flex;justify-content:space-between;align-items:center;
border:1px solid var(--border);
padding:12px;border-radius:14px
}

footer{text-align:center;font-size:11px;color:var(--muted);margin-top:40px}
</style>
</head>

<body>
<div class="wrap">

<header>
<div class="brand"><div class="logo"></div>TRINITY Swap</div>
<div style="display:flex;gap:10px;align-items:center">
<div class="pill" id="net">R√©seau ‚Äî</div>
<div class="pill" id="wallet">Wallet non connect√©</div>
<button class="btn" id="connect">Connect Wallet</button>
</div>
</header>

<section class="hero">
<div class="card">
<h1>Swap 3 tokens en parall√®le.<br>Une interface, trois actions.</h1>
<p style="margin-top:10px;color:var(--muted)">
TRINITY = MultiSwap PulseChain. UI au-dessus du router PulseX.<br>
Mode 1 ‚Ä¢ Non-custodial ‚Ä¢ 0 fee TRINITY
</p>

<div class="chips">
<div class="chip">3 swaps ind√©pendants</div>
<div class="chip">Style PulseChain-like</div>
<div class="chip">Quotes live</div>
<div class="chip">Web3 ready</div>
</div>

<div style="display:flex;gap:10px;flex-wrap:wrap">
<button class="btn" onclick="document.getElementById('multi').scrollIntoView({behavior:'smooth'})">üöÄ Ouvrir le MultiSwap</button>
<a class="btn2" href="https://whaletrackerio.github.io/autopilot-pulsechain/" target="_blank">‚ö° AutoPilot</a>
<a class="btn2" href="https://whaletrackerio.github.io/dca-pulsechain/" target="_blank">üìà DCA</a>
</div>

<div class="warn" style="margin-top:14px">
‚ö†Ô∏è Teste avec de petits montants. TRINITY ne garde pas tes fonds.
</div>
</div>

<div class="card">
<label>Slippage (%)</label>
<input id="slippage" value="2">

<label style="margin-top:10px">Deadline (minutes)</label>
<input id="deadline" value="10">

<div class="warn" style="margin-top:14px">
Explorer : <a href="https://otter.pulsechain.com" target="_blank">otter.pulsechain.com</a>
</div>

<button class="btn2" style="margin-top:14px" onclick="refreshAll()">‚Üª Refresh balances / quotes</button>
</div>
</section>

<h3 id="multi" style="margin-top:30px">MULTISWAP</h3>

<section class="swaps" id="swaps"></section>

<section class="links">
<div class="card">
<b>Notes</b>
<p style="margin-top:8px;color:var(--muted)">
Mode 1 = pas de fee TRINITY, pas de smart contract maison.<br>
Chaque swap = 1 transaction.
</p>
<div class="warn" style="margin-top:10px">
Astuce : partage TRINITY sur X, √ßa ram√®ne des users qualifi√©s vers tes bots.
</div>
</div>

<div class="card">
<b>LIENS RAPIDES</b>

<div class="linkItem"><span>PulseX</span><a class="btn2" href="https://pulsex.com" target="_blank">Ouvrir</a></div>
<div class="linkItem"><span>PulseScan</span><a class="btn2" href="https://scan.pulsechain.com" target="_blank">Explorer</a></div>
<div class="linkItem"><span>AutoPilot</span><a class="btn2" href="https://whaletrackerio.github.io/autopilot-pulsechain/" target="_blank">Aller</a></div>
<div class="linkItem"><span>DCA PulseChain</span><a class="btn2" href="https://whaletrackerio.github.io/dca-pulsechain/" target="_blank">Aller</a></div>
</div>
</section>

<footer>
TRINITY Swap ‚Äî PulseChain ‚Ä¢ Mode 1 ‚Ä¢ Aucun frais TRINITY<br>
Utilise √† tes risques.
</footer>

</div>

<script>
/* ================= CONFIG ================= */

// ROUTER EXACT DE TES BOTS
const PULSEX_ROUTER = "0x98bf93ebf5c380C0e6Ae8e192A7e2AE08edAcc02";
const PULSECHAIN_ID = 369;
const WPLS = "0xA1077a294dDE1B09bB078844df40758a5D0f9a27";

const TOKENS = {
PLS:{address:null,decimals:18},
PHEX:{address:"0x2b591e99afE9f32eAA6214f7B7629768c40Eeb39",decimals:8},
ATROPA:{address:"0xCc78A0acDF847A2C1714D2A925bB4477df5d48a6",decimals:18},
PLSX:{address:"0x95B303987A60C71504D99Aa1b13B4DA07b0790ab",decimals:18},
DAI:{address:"0x6B175474E89094C44Da98b954EedeAC495271d0F",decimals:18}
};

const ERC20_ABI=[
"function balanceOf(address) view returns(uint)",
"function allowance(address,address) view returns(uint)",
"function approve(address,uint) returns(bool)"
];

const ROUTER_ABI=[
"function getAmountsOut(uint,address[]) view returns(uint[])",
"function swapExactTokensForTokens(uint,uint,address[],address,uint)",
"function swapExactETHForTokens(uint,address[],address,uint) payable",
"function swapExactTokensForETH(uint,uint,address[],address,uint)"
];

let provider,signer,user;

/* ================= UI BUILD ================= */

const swaps=document.getElementById("swaps");

["Swap A","Swap B","Swap C"].forEach((name,i)=>{
swaps.innerHTML+=`
<div class="card" id="c${i}">
<b>${name}</b>
<label>Tu payes</label>
<div class="row2">
<select class="from"></select>
<input class="amt" placeholder="Montant">
</div>
<div class="balRow">
<span>Balance: <span class="bal">‚Äî</span></span>
<button class="maxBtn">MAX</button>
</div>

<div class="switch"><button>‚Üï</button></div>

<label>Tu re√ßois</label>
<div class="row2">
<select class="to"></select>
<input readonly placeholder="Estimation">
</div>

<button class="btn" style="margin-top:12px">Ex√©cuter ${name}</button>
<div class="status">Ready</div>
</div>`;
});

document.querySelectorAll(".from,.to").forEach(sel=>{
Object.keys(TOKENS).forEach(t=>{
sel.innerHTML+=`<option>${t}</option>`;
});
});

/* ================= WALLET ================= */

document.getElementById("connect").onclick=async()=>{
await window.ethereum.request({method:"eth_requestAccounts"});
provider=new ethers.BrowserProvider(window.ethereum);
signer=await provider.getSigner();
user=await signer.getAddress();
const net=await provider.getNetwork();

document.getElementById("wallet").textContent=user.slice(0,6)+"‚Ä¶"+user.slice(-4);
document.getElementById("net").textContent=Number(net.chainId)===PULSECHAIN_ID?"PulseChain":"Wrong network";

refreshAll();
};

/* ================= BALANCE + MAX ================= */

async function getBalance(token){
if(token==="PLS") return await provider.getBalance(user);
const c=new ethers.Contract(TOKENS[token].address,ERC20_ABI,provider);
return await c.balanceOf(user);
}

async function refreshAll(){
document.querySelectorAll("#swaps .card").forEach(async card=>{
const from=card.querySelector(".from").value;
const bal=await getBalance(from);
card.querySelector(".bal").textContent=ethers.formatUnits(bal,TOKENS[from].decimals);
});
}

document.querySelectorAll(".maxBtn").forEach(btn=>{
btn.onclick=async e=>{
const card=e.target.closest(".card");
const from=card.querySelector(".from").value;
let bal=await getBalance(from);
if(from==="PLS") bal-=ethers.parseUnits("0.05",18);
card.querySelector(".amt").value=ethers.formatUnits(bal,TOKENS[from].decimals);
};
});
</script>
</body>
</html>
